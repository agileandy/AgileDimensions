(()=>{"use strict";const e=e=>"string"==typeof e?decodeURIComponent(e).toLowerCase().trimStart():e,t="client-session-bind",o=new Set([t,"client-binding","svSession","smSession","server-session-bind","wixSession2"].map((e=>e.toLowerCase()))),r=Object.getOwnPropertyDescriptor(Document.prototype,"cookie"),i=(e="")=>`${t}=; ${e} max-age=0; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT`,n=t=>{const r="string"==typeof t?t.split("=")[0].trim():t.name,i=e(r).toLowerCase();return o.has(i)},s=e=>{let t;return t="string"==typeof e?e.split(";").map((e=>e.trim())):e,t.filter((e=>!n(e)))},l="tbReady",a="security_overrideGlobals",{isExcludedFromSecurityExperiments:c,experiments:d,siteFeaturesConfigs:u,accessTokensUrl:b}=window.viewerModel,g=b,m={},h=(()=>{const e=document.cookie.split(";").map((e=>e.trim())).filter((e=>e.startsWith(t)))[0]?.split("=")[1];return(()=>{const e=`domain=${location.hostname};`,t=i(),o=i(e);r.set.call(document,t),r.set.call(document,o)})(),e})();if(h&&(m["client-binding"]=h),d["specs.thunderbolt.hardenFetchAndXHR"]&&!c){let p=fetch;function f(e){const{logger:t}=e.detail;try{window.tb.init({fetch:p,fetchHeaders:m})}catch(e){const o=new Error("TB003");t.captureError(o,{tags:{feature:"thunderbolt-security"}}),t.meter(`${a}_${o.message}`,{paramsOverrides:{evid:"26",errorType:a,eventString:o.message}}),window?.viewerModel?.mode.debug&&console.error(e)}finally{removeEventListener(l,f),p=fetch}}addEventListener(l,f)}else window.fetchDynamicModel=()=>u.sessionManager.isRunningInDifferentSiteContext?Promise.resolve({}):fetch(g,{credentials:"same-origin",headers:m}).then((function(e){if(!e.ok)throw new Error(`[${e.status}]${e.statusText}`);return e.json()})),window.dynamicModelPromise=window.fetchDynamicModel();Object.defineProperty(document,"cookie",{get(){const e=r.get.call(document);return s(e).join("; ")},set(t){const i=e(t.split(";")[0]);[...o].every((e=>!i.startsWith(e.toLowerCase())))&&r.set.call(document,t)},enumerable:!0,configurable:!1}),d["specs.thunderbolt.hardenCookieStoreAccess"]&&(()=>{if(!globalThis.cookieStore)return;const e=globalThis.cookieStore.get.bind(globalThis.cookieStore),t=globalThis.cookieStore.getAll.bind(globalThis.cookieStore),r=globalThis.cookieStore.set.bind(globalThis.cookieStore),i=globalThis.cookieStore.delete.bind(globalThis.cookieStore);Object.defineProperty(globalThis.CookieStore.prototype,"get",{value:async t=>o.has(t.toLowerCase())?null:e.call(void 0,t),enumerable:!0,configurable:!1}),Object.defineProperty(globalThis.CookieStore.prototype,"getAll",{value:async()=>{const e=await t.call(void 0);return s(e)},enumerable:!0,configurable:!1}),Object.defineProperty(globalThis.CookieStore.prototype,"set",{value:async(...e)=>{const t=1===e.length?e[0].name:e[0];if(!n(t))return r.call(void 0,...e)},enumerable:!0,configurable:!1}),Object.defineProperty(globalThis.CookieStore.prototype,"delete",{value:async(...e)=>{const t=1===e.length?e[0].name:e[0];if(!n(t))return i.call(void 0,...e)},enumerable:!0,configurable:!1})})()})();
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/handleAccessTokens.inline.88ae3459.bundle.min.js.map